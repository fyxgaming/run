/**
 * txo.js
 *
 * Tests for lib/extra/txo.js
 */

const { describe, it } = require('mocha')
const { expect } = require('chai')
const Run = require('../env/run')
const { txo } = Run.extra

// ------------------------------------------------------------------------------------------------
// txo
// ------------------------------------------------------------------------------------------------

describe('txo', () => {
  it('parses transaction', () => {
    const rawtx = '010000000152be1adbf94555019711aef6b00795516852a06c5f5afe2b03ffd9b14dfa053d010000006b483045022100deafb89e740bb70d6c28e2d722f680ecdd7036ae29b0f3fac13108421d9bdfaf02205e2d93da4bc7942986c3c7501466844c98949dd1367c8088bbc780abb79999fe4121039c35c5f7452059e4fb9fd02f317635cba01d7d5adfa55048a507129155884c91ffffffff030000000000000000fdcc01006a2231394878696756345179427633744870515663554551797131707a5a56646f4175743843616d6520666f72207468652065646779206d61726b6574696e672c2073746179656420666f722074727574682026206b696e646e6573730a746578742f706c61696e04746578741f7477657463685f7477746578745f313538313133373730353033392e747874017c223150755161374b36324d694b43747373534c4b79316b683536575755374d74555235035345540b7477646174615f6a736f6e046e756c6c0375726c046e756c6c07636f6d6d656e74046e756c6c076d625f757365720432333530047479706504706f73740974696d657374616d701131323234363635363235393932343435340361707006747765746368017c22313550636948473232534e4c514a584d6f53556157566937575371633768436676610d424954434f494e5f454344534122314a4c4275744d5a5055377875325055425078656b5463704a4b507a5a756154755a4c584945616d6b7772394865727332774f6c46553246307a50316f68654e38685a583047796666704c517541673952594b3359384c3152586f7455736b4f6733776965343265436b5558326e69725739782f336b38455231773d4d180000000000001976a91405186ff0710ed004229e644c0653b2985c648a2388accd1f0000000000001976a9140710fe5e246c1f1b2e31aa10bbc6ff041a1e1e8088ac00000000'
    const data = txo(rawtx)
    expect(data.lock).to.equal(0)
    expect(data.in[0].e.h).to.equal('3d05fa4db1d9ff032bfe5a5f6ca05268519507b0f6ae1197015545f9db1abe52')
    expect(data.in[0].e.i).to.equal(1)
    expect(data.out[0].s2).to.equal('19HxigV4QyBv3tHpQVcUEQyq1pzZVdoAut')
    expect(data.out[0].s3).to.equal('Came for the edgy marketing, stayed for truth & kindness')
  })
})

// ------------------------------------------------------------------------------------------------
